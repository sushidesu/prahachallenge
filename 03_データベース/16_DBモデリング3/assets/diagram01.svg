<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="717px" preserveAspectRatio="none" style="width:1233px;height:717px;" version="1.1" viewBox="0 0 1233 717" width="1233px" zoomAndPan="magnify"><defs><filter height="300%" id="f1nybz2tjh053v" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><rect codeLine="1" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="73.6094" id="User" style="stroke:#A80036;stroke-width:1.5;" width="61" x="577" y="630"/><ellipse cx="592" cy="646" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M596.1094,652 L588.3906,652 L588.3906,639.6094 L596.1094,639.6094 L596.1094,641.7656 L590.8438,641.7656 L590.8438,644.4375 L595.6094,644.4375 L595.6094,646.5938 L590.8438,646.5938 L590.8438,649.8438 L596.1094,649.8438 L596.1094,652 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="29" x="606" y="650.1543">User</text><line style="stroke:#A80036;stroke-width:1.5;" x1="578" x2="637" y1="662" y2="662"/><ellipse cx="588" cy="673" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="597" y="676.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="578" x2="637" y1="682.8047" y2="682.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="32" x="583" y="697.0151">name</text><!--MD5=[9bd2b2bc45261200a440e1ecb7c43192]
class Directory--><rect codeLine="7" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="86.4141" id="Directory" style="stroke:#A80036;stroke-width:1.5;" width="88" x="382.5" y="91"/><ellipse cx="397.5" cy="107" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M401.6094,113 L393.8906,113 L393.8906,100.6094 L401.6094,100.6094 L401.6094,102.7656 L396.3438,102.7656 L396.3438,105.4375 L401.1094,105.4375 L401.1094,107.5938 L396.3438,107.5938 L396.3438,110.8438 L401.6094,110.8438 L401.6094,113 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="56" x="411.5" y="111.1543">Directory</text><line style="stroke:#A80036;stroke-width:1.5;" x1="383.5" x2="469.5" y1="123" y2="123"/><ellipse cx="393.5" cy="134" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="402.5" y="137.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="383.5" x2="469.5" y1="143.8047" y2="143.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="73" x="388.5" y="158.0151">name: string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="388.5" y="170.8198">statusId [fk]</text><path d="M312,6 L312,31.1328 A0,0 0 0 0 312,31.1328 L422.5,31.1328 L426.5,90.8227 L430.5,31.1328 L541,31.1328 A0,0 0 0 0 541,31.1328 L541,16 L531,6 L312,6 A0,0 0 0 0 312,6 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M531,6 L531,16 L541,16 L531,6 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="318" y="23.0669">空のディレクトリも作成可能とした</text><!--MD5=[7c3a4621a85ec680af9a98c936fd137a]
class DirectoryTree--><rect codeLine="17" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="86.4141" id="DirectoryTree" style="stroke:#A80036;stroke-width:1.5;" width="187" x="506" y="91"/><ellipse cx="553.25" cy="107" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M557.3594,113 L549.6406,113 L549.6406,100.6094 L557.3594,100.6094 L557.3594,102.7656 L552.0938,102.7656 L552.0938,105.4375 L556.8594,105.4375 L556.8594,107.5938 L552.0938,107.5938 L552.0938,110.8438 L557.3594,110.8438 L557.3594,113 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="573.75" y="111.1543">DirectoryTree</text><line style="stroke:#A80036;stroke-width:1.5;" x1="507" x2="692" y1="123" y2="123"/><ellipse cx="517" cy="134" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="526" y="137.2104">(ascendantId, descendantId)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="507" x2="692" y1="143.8047" y2="143.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="512" y="158.0151">ascendantId [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="512" y="170.8198">descendantId [fk]</text><path d="M728.5,114 L728.5,130 L693.25,134 L728.5,138 L728.5,154.2656 A0,0 0 0 0 728.5,154.2656 L970.5,154.2656 A0,0 0 0 0 970.5,154.2656 L970.5,124 L960.5,114 L728.5,114 A0,0 0 0 0 728.5,114 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M960.5,114 L960.5,124 L970.5,124 L960.5,114 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="734.5" y="131.0669">閉包テーブルを使用することで</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="734.5" y="146.1997">サブディレクトリを無制限に作成可能</text><!--MD5=[2b3da787ff7efb35f38dd9c119b8bebc]
class DirectoryStatus--><rect codeLine="30" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="73.6094" id="DirectoryStatus" style="stroke:#A80036;stroke-width:1.5;" width="129" x="218" y="97"/><ellipse cx="233" cy="113" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M237.1094,119 L229.3906,119 L229.3906,106.6094 L237.1094,106.6094 L237.1094,108.7656 L231.8438,108.7656 L231.8438,111.4375 L236.6094,111.4375 L236.6094,113.5938 L231.8438,113.5938 L231.8438,116.8438 L237.1094,116.8438 L237.1094,119 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97" x="247" y="117.1543">DirectoryStatus</text><line style="stroke:#A80036;stroke-width:1.5;" x1="219" x2="346" y1="129" y2="129"/><ellipse cx="229" cy="140" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="238" y="143.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="219" x2="346" y1="149.8047" y2="149.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="224" y="164.0151">status: string</text><path d="M6,121.5 L6,146.6328 A0,0 0 0 0 6,146.6328 L183,146.6328 A0,0 0 0 0 183,146.6328 L183,139.5 L217.8262,134 L183,131.5 L183,131.5 L173,121.5 L6,121.5 A0,0 0 0 0 6,121.5 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M173,121.5 L173,131.5 L183,131.5 L173,121.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="12" y="138.5669">status は active, inactive</text><!--MD5=[59b530d44ae785dc18db921986a9c15c]
class Document--><rect codeLine="39" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="73.6094" id="Document" style="stroke:#A80036;stroke-width:1.5;" width="96" x="573.5" y="403"/><ellipse cx="588.5" cy="419" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M592.6094,425 L584.8906,425 L584.8906,412.6094 L592.6094,412.6094 L592.6094,414.7656 L587.3438,414.7656 L587.3438,417.4375 L592.1094,417.4375 L592.1094,419.5938 L587.3438,419.5938 L587.3438,422.8438 L592.6094,422.8438 L592.6094,425 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="64" x="602.5" y="423.1543">Document</text><line style="stroke:#A80036;stroke-width:1.5;" x1="574.5" x2="668.5" y1="435" y2="435"/><ellipse cx="584.5" cy="446" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="593.5" y="449.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="574.5" x2="668.5" y1="455.8047" y2="455.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="579.5" y="470.0151">statusId [fk]</text><!--MD5=[fdb11eaee86c269afe9cc1c8b5d9effe]
class DocumentStatus--><rect codeLine="45" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="73.6094" id="DocumentStatus" style="stroke:#A80036;stroke-width:1.5;" width="137" x="553" y="237"/><ellipse cx="568" cy="253" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M572.1094,259 L564.3906,259 L564.3906,246.6094 L572.1094,246.6094 L572.1094,248.7656 L566.8438,248.7656 L566.8438,251.4375 L571.6094,251.4375 L571.6094,253.5938 L566.8438,253.5938 L566.8438,256.8438 L572.1094,256.8438 L572.1094,259 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="582" y="257.1543">DocumentStatus</text><line style="stroke:#A80036;stroke-width:1.5;" x1="554" x2="689" y1="269" y2="269"/><ellipse cx="564" cy="280" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="573" y="283.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="554" x2="689" y1="289.8047" y2="289.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="559" y="304.0151">status: string</text><path d="M725,261.5 L725,270 L690.125,274 L725,278 L725,286.6328 A0,0 0 0 0 725,286.6328 L902,286.6328 A0,0 0 0 0 902,286.6328 L902,271.5 L892,261.5 L725,261.5 A0,0 0 0 0 725,261.5 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M892,261.5 L892,271.5 L902,271.5 L892,261.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="731" y="278.5669">status は active, inactive</text><!--MD5=[da9182fe8b91957755ac471895828e53]
class UserPostDocumentToDirectory--><rect codeLine="54" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="124.8281" id="UserPostDocumentToDirectory" style="stroke:#A80036;stroke-width:1.5;" width="224" x="314.5" y="377.5"/><ellipse cx="329.5" cy="393.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M333.6094,399.5 L325.8906,399.5 L325.8906,387.1094 L333.6094,387.1094 L333.6094,389.2656 L328.3438,389.2656 L328.3438,391.9375 L333.1094,391.9375 L333.1094,394.0938 L328.3438,394.0938 L328.3438,397.3438 L333.6094,397.3438 L333.6094,399.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="192" x="343.5" y="397.6543">UserPostDocumentToDirectory</text><line style="stroke:#A80036;stroke-width:1.5;" x1="315.5" x2="537.5" y1="409.5" y2="409.5"/><ellipse cx="325.5" cy="420.5" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="334.5" y="423.7104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="315.5" x2="537.5" y1="430.3047" y2="430.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="62" x="320.5" y="444.5151">title: string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="320.5" y="457.3198">content: string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="320.5" y="470.1245">directoryId [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="320.5" y="482.9292">postedBy [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="320.5" y="495.7339">postedAt: date</text><path d="M89.5,427.5 L89.5,452.6328 A0,0 0 0 0 89.5,452.6328 L279.5,452.6328 A0,0 0 0 0 279.5,452.6328 L279.5,445.5 L314.2432,440 L279.5,437.5 L279.5,437.5 L269.5,427.5 L89.5,427.5 A0,0 0 0 0 89.5,427.5 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M269.5,427.5 L269.5,437.5 L279.5,437.5 L269.5,427.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="95.5" y="444.5669">ドキュメントの投稿イベント</text><!--MD5=[1554cc10a08ff7829357b354e5969a8a]
class UserUpdateDocument--><rect codeLine="71" fill="#FEFECE" filter="url(#f1nybz2tjh053v)" height="137.6328" id="UserUpdateDocument" style="stroke:#A80036;stroke-width:1.5;" width="171" x="705" y="371"/><ellipse cx="720" cy="387" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M724.1094,393 L716.3906,393 L716.3906,380.6094 L724.1094,380.6094 L724.1094,382.7656 L718.8438,382.7656 L718.8438,385.4375 L723.6094,385.4375 L723.6094,387.5938 L718.8438,387.5938 L718.8438,390.8438 L724.1094,390.8438 L724.1094,393 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="139" x="734" y="391.1543">UserUpdateDocument</text><line style="stroke:#A80036;stroke-width:1.5;" x1="706" x2="875" y1="403" y2="403"/><ellipse cx="716" cy="414" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="10" x="725" y="417.2104">id</text><line style="stroke:#A80036;stroke-width:1.0;" x1="706" x2="875" y1="423.8047" y2="423.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="711" y="438.0151">previousUpdateId [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="62" x="711" y="450.8198">title: string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="711" y="463.6245">content: string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="711" y="476.4292">documentId [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="711" y="489.2339">updatedBy [fk]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="90" x="711" y="502.0386">updatedAt: date</text><path d="M911,420 L911,436 L876.251,440 L911,444 L911,460.2656 A0,0 0 0 0 911,460.2656 L1224,460.2656 A0,0 0 0 0 1224,460.2656 L1224,430 L1214,420 L911,420 A0,0 0 0 0 911,420 " fill="#FBFB77" filter="url(#f1nybz2tjh053v)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1214,420 L1214,430 L1224,430 L1214,420 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="917" y="437.0669">ドキュメントの更新イベント</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="917" y="452.1997">previousUpdateIdが自身のidと一致するなら最新</text><!--MD5=[7e8097113f14a1aace99d2540c8df211]
link Directory to DirectoryTree--><path codeLine="28" d="M479.014,134 C485.3306,134 491.6473,134 497.9639,134 " fill="none" id="Directory-DirectoryTree" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="497.965" x2="505.965" y1="134" y2="128"/><line style="stroke:#A80036;stroke-width:1.0;" x1="497.965" x2="505.965" y1="134" y2="140"/><line style="stroke:#A80036;stroke-width:1.0;" x1="497.965" x2="505.965" y1="134" y2="134"/><ellipse cx="491.965" cy="134" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="474.7637" x2="474.7637" y1="138" y2="130"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="477.7637" x2="477.7637" y1="138" y2="130"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="478.7637" x2="470.7637" y1="134" y2="134"/><!--MD5=[f532fbb125a6acf35ae28feee09c0421]
link DirectoryStatus to Directory--><path codeLine="37" d="M355.3927,134 C361.5353,134 367.6778,134 373.8203,134 " fill="none" id="DirectoryStatus-Directory" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374.1965" x2="382.1965" y1="134" y2="128"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374.1965" x2="382.1965" y1="134" y2="140"/><line style="stroke:#A80036;stroke-width:1.0;" x1="374.1965" x2="382.1965" y1="134" y2="134"/><ellipse cx="368.1965" cy="134" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="351.1875" x2="351.1875" y1="138" y2="130"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="354.1875" x2="354.1875" y1="138" y2="130"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="355.1875" x2="347.1875" y1="134" y2="134"/><!--MD5=[bc76984a85002c74fc92dab35ae36384]
link DocumentStatus to Document--><path codeLine="52" d="M621.5,319.5206 C621.5,342.9575 621.5,371.4412 621.5,394.8278 " fill="none" id="DocumentStatus-Document" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="621.5" x2="627.5" y1="394.8707" y2="402.8707"/><line style="stroke:#A80036;stroke-width:1.0;" x1="621.5" x2="615.5" y1="394.8707" y2="402.8707"/><line style="stroke:#A80036;stroke-width:1.0;" x1="621.5" x2="621.5" y1="394.8707" y2="402.8707"/><ellipse cx="621.5" cy="388.8707" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="617.5" x2="625.5" y1="315.2536" y2="315.2536"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="617.5" x2="625.5" y1="318.2536" y2="318.2536"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="621.5" x2="621.5" y1="319.2536" y2="311.2536"/><!--MD5=[19e6c2815420b8f2e3b2561a69bbe2c3]
link Directory to UserPostDocumentToDirectory--><path codeLine="67" d="M426.5,185.4199 C426.5,235.8321 426.5,313.0837 426.5,369.269 " fill="none" id="Directory-UserPostDocumentToDirectory" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="426.5" x2="432.5" y1="369.4001" y2="377.4001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="426.5" x2="420.5" y1="369.4001" y2="377.4001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="426.5" x2="426.5" y1="369.4001" y2="377.4001"/><ellipse cx="426.5" cy="363.4001" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="422.5" x2="430.5" y1="181.1933" y2="181.1933"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="422.5" x2="430.5" y1="184.1933" y2="184.1933"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="426.5" x2="426.5" y1="185.1933" y2="177.1933"/><!--MD5=[cf83781d78f1556ab8a17fba6363a309]
link UserPostDocumentToDirectory to Document--><path codeLine="68" d="M546.9497,440 C553.0106,440 559.0714,440 565.1323,440 " fill="none" id="UserPostDocumentToDirectory-Document" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="569.3972" x2="569.3972" y1="436" y2="444"/><line style="stroke:#A80036;stroke-width:1.0;" x1="566.3972" x2="566.3972" y1="436" y2="444"/><line style="stroke:#A80036;stroke-width:1.0;" x1="565.3972" x2="573.3972" y1="440" y2="440"/><line style="stroke:#A80036;stroke-width:1.0;" x1="546.8535" x2="538.8535" y1="440" y2="446"/><line style="stroke:#A80036;stroke-width:1.0;" x1="546.8535" x2="538.8535" y1="440" y2="434"/><line style="stroke:#A80036;stroke-width:1.0;" x1="546.8535" x2="538.8535" y1="440" y2="440"/><ellipse cx="552.8535" cy="440" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><!--MD5=[20fa7fa9739fc1cf59c7f0489497af93]
link UserPostDocumentToDirectory to User--><path codeLine="69" d="M481.4611,508.9291 C511.1658,546.183 546.9432,591.0531 572.7788,623.4547 " fill="none" id="UserPostDocumentToDirectory-User" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="578.4425" x2="572.1875" y1="624.1416" y2="629.129"/><line style="stroke:#A80036;stroke-width:1.0;" x1="576.5722" x2="570.3172" y1="621.7959" y2="626.7834"/><line style="stroke:#A80036;stroke-width:1.0;" x1="572.8213" x2="577.8087" y1="623.5078" y2="629.7628"/><line style="stroke:#A80036;stroke-width:1.0;" x1="481.4256" x2="471.7469" y1="508.8846" y2="506.3702"/><line style="stroke:#A80036;stroke-width:1.0;" x1="481.4256" x2="481.1295" y1="508.8846" y2="498.889"/><line style="stroke:#A80036;stroke-width:1.0;" x1="481.4256" x2="476.4382" y1="508.8846" y2="502.6296"/><ellipse cx="485.1662" cy="513.5759" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><!--MD5=[345be0b63e9f37ebd4edf4f05c159574]
link Document to UserUpdateDocument--><path codeLine="86" d="M677.8761,440 C684.0032,440 690.1303,440 696.2575,440 " fill="none" id="Document-UserUpdateDocument" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="696.6126" x2="704.6126" y1="440" y2="434"/><line style="stroke:#A80036;stroke-width:1.0;" x1="696.6126" x2="704.6126" y1="440" y2="446"/><line style="stroke:#A80036;stroke-width:1.0;" x1="696.6126" x2="704.6126" y1="440" y2="440"/><ellipse cx="690.6126" cy="440" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="673.6914" x2="673.6914" y1="444" y2="436"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="676.6914" x2="676.6914" y1="444" y2="436"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="677.6914" x2="669.6914" y1="440" y2="440"/><!--MD5=[11cd6df2264217a3c31f87039caad58b]
link UserUpdateDocument to User--><path codeLine="87" d="M729.5273,515.6328 C700.6004,551.5148 667.0761,593.0996 642.4938,623.5924 " fill="none" id="UserUpdateDocument-User" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="643.0134" x2="636.7852" y1="629.3212" y2="624.3002"/><line style="stroke:#A80036;stroke-width:1.0;" x1="644.8962" x2="638.6681" y1="626.9857" y2="621.9647"/><line style="stroke:#A80036;stroke-width:1.0;" x1="642.4098" x2="637.3888" y1="623.6967" y2="629.9248"/><line style="stroke:#A80036;stroke-width:1.0;" x1="729.8276" x2="730.1775" y1="515.2601" y2="505.2663"/><line style="stroke:#A80036;stroke-width:1.0;" x1="729.8276" x2="739.5197" y1="515.2601" y2="512.7977"/><line style="stroke:#A80036;stroke-width:1.0;" x1="729.8276" x2="734.8486" y1="515.2601" y2="509.032"/><ellipse cx="726.0619" cy="519.9312" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.0;fill:none;"/><!--MD5=[344ec21a1780dd58c719290e9d587e5d]
@startuml
entity User {
  + id
  - - -
  name
}

entity Directory {
  + id
  - - -
  name: string
  statusId [fk]
}
note top
空のディレクトリも作成可能とした
end note

entity DirectoryTree {
  + (ascendantId, descendantId)
  - - -
  ascendantId [fk]
  descendantId [fk]
}
note right
閉包テーブルを使用することで
サブディレクトリを無制限に作成可能
end note

Directory ||-o{ DirectoryTree

entity DirectoryStatus {
  + id
  - - -
  status: string
}
note left: status は active, inactive

DirectoryStatus ||-o{ Directory

entity Document {
  + id
  - - -
  statusId [fk]
}

entity DocumentStatus {
  + id
  - - -
  status: string
}
note right: status は active, inactive

DocumentStatus ||- -o{ Document

entity UserPostDocumentToDirectory {
  + id
  - - -
  title: string
  content: string
  directoryId [fk]
  postedBy [fk]
  postedAt: date
}
note left
ドキュメントの投稿イベント
end note

Directory ||- - -o{ UserPostDocumentToDirectory
UserPostDocumentToDirectory }o-|| Document
UserPostDocumentToDirectory }o- - -|| User

entity UserUpdateDocument {
  + id
  - - -
  previousUpdateId [fk]
  title: string
  content: string
  documentId [fk]
  updatedBy [fk]
  updatedAt: date
}
note right
ドキュメントの更新イベント
previousUpdateIdが自身のidと一致するなら最新
end note

Document ||-o{ UserUpdateDocument
UserUpdateDocument }o- - -|| User
@enduml

PlantUML version 1.2021.5(Sun Apr 25 11:20:28 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>