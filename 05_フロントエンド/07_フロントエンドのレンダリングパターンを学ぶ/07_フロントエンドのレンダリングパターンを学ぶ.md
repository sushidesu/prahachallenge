# フロントエンドのレンダリングパターンを学ぶ

## 課題1

- CSR
  - クライアントサイドレンダリング
    - サーバーからは主にJSファイルを返し、クライアントのブラウザにてデータ取得とレンダリング(DOMの構築)を行う
  - データ取得: クライアントのブラウザにレンダリングされた後
  - レンダリング(DOMの構築): リクエスト後、クライアントブラウザにて
  - 利点
    - JSによる柔軟なデータ取得
    - ページ遷移することなくJSにてページ全体を置き換えるため、インタラクションが高速
    - ページの生成がクライアントのブラウザで行われるため、ユーザーによって表示が変わるページや、認証が必要なページには有利
    - サーバーはHTML+CSSを配信するだけでいいので、デプロイ先の選択肢が増える
    - シンプル
  - 欠点
    - 大きなJSファイルを読み込むため、初期表示が遅い
    - ページ内容をキャッシュすることができないため、ページの表示速度は落ちる。SEO的に不利。
    - Googleの検索エンジンはJavaScriptを解釈してくれるが、完全ではないため、SEO的に不利。
    - 空のHTMLを返すため、動的なOGPをつけることができない
- SSR
  - サーバーサイドレンダリング
    - クライアントからのリクエストに応じて、サーバーにてレンダリングを行い、生成されたHTMLを返す
    - リクエストに応じて動的にページの内容を変えつつ、静的なHTMLを返すことができる
    - 従来のサーバーサイドアプリと同じ
  - データ取得: クライアントからリクエストが届いた後
  - レンダリング(DOMの構築): リクエスト後、サーバーにて
  - 利点
    - ページの内容をキャッシュできる
    - サーバーから配信されるのは主にHTMLファイルのため、CSRと比較してSEO的に有利
  - 欠点
    - リクエストが届いてからデータ取得・DOM構築を行うため、SSGに比べて応答速度が下がる
- SSG
  - スタティックサイトジェネレーション
    - あらかじめアプリケーション全体のHTMLファイルを生成しておき、それを返す
  - データ取得: アプリケーションのビルド時
  - レンダリング(DOMの構築): アプリケーションのビルド時
  - 利点
    - 応答速度、ページの表示速度ともに最速
    - キャッシュ可能
  - 欠点
    - ページの内容を更新するたびにアプリケーション全体をビルドし直さなければならないため、頻繁に更新されるサイトには向かない
- ISR
  - Incremental Static Regeneration
    - リクエスト時にバックグラウンドで静的HTMLを生成しつつ、クライアントには前回生成済みのHTML(キャッシュ)を返す
    - キャッシュの有効期限内であれば、HTMLの再生成は行われない
  - データ取得: キャッシュの有効期限が切れたあとのリクエスト時
  - DOMの構築: リクエスト時、サーバーにて
  - 利点
    - 生成済みのHTMLを返すため、レスポンスが高速
    - ページ単位でビルドが行われるため、SSGに比べてビルドコストが低い
    - キャッシュの有効期限内であればキャッシュ済みのデータを返すため、大量のリクエストにも強い
    - 一定期間でキャッシュを更新するため、SSGに比べて新しいデータを返すことができる
  - 欠点
    - 前回のリクエストでキャッシュ(生成)されたデータを返すため、最新のコンテンツを返すことができない
    - 基本的に Next.js+Vercel でしか使用できないため、ロックインされてしまう

### 参考

- [Next.jsのISRで動的コンテンツをキャッシュするときの戦略](https://zenn.dev/catnose99/articles/8bed46fb271e44)
- [図解 CSR, SSR, SG(SSG), ISR](https://zenn.dev/bitarts/articles/37260ddb28ae5d)
- [Vercel以外でNext.jsのISRをできるのか問題](https://zenn.dev/catnose99/scraps/f1c9a98c5651f1)
- [もう迷わないNext.jsのCSR/SSR/SSG/ISR](https://zenn.dev/a_da_chi/articles/105dac5573b2f5)

## 課題2

- starデータの取得
- ビルド後の成果物の違い

- SSR
- CSR
- SSG
- ISR


## 課題3

どれを採用すべきか？

- 週1更新ブログ
  - SSG
- ユーザーのコメントが随時追加されるレシピ共有サービス
  - SSG + CSR
- 会計サービス
  - CSR
- 経営指標を管理する社内サービス
  - CSR
- 社内SNS
  - CSR

> catnose 2021/02/06に更新
>
> ※ 略語に馴染みがない方のために括弧で正式名称を書いておきます。
>
> 利用規約やプライバシーポリシー、AboutページなどはSSG（Static Site Generation）を使用しています。使い分けとしては
>
> - ダッシュボードなどのログインユーザーのみ閲覧ができるページ => CSR（Client Side Rendering）
> - SEO上重要かつページネーションが必要な一覧ページ => SSR（Server Side Rendering）
> - スクラップのように更新頻度が高いページ => SSR
> - 記事や本などの速度が重要なページ => ISR（Incremental Static Regeneration）
>
> という感じです。
>
> from: https://zenn.dev/link/comments/a34b65c6ddf486
